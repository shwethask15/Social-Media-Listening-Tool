<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-time Alerts</title>
</head>
<body>
    <h1>Real-time Alerts</h1>

    <ul id="alerts"></ul>

    <script>
        // Function to handle WebSocket connection
        function connectWebSocket() {
            const socket = new WebSocket("ws://localhost:8000/ws"); // Replace with your WebSocket endpoint

            socket.onopen = function(event) {
                console.log("WebSocket connected");
            };

            socket.onmessage = function(event) {
                const data = JSON.parse(event.data);
                const newAlerts = data.new_data;

                newAlerts.forEach(alert => {
                    const li = document.createElement('li');
                    li.textContent = `${alert.message} - ${formatDate(alert.mention_updated_date)}`;
                    document.getElementById('alerts').appendChild(li);
                });
            };

            socket.onclose = function(event) {
                console.log("WebSocket disconnected");
            };

            socket.onerror = function(event) {
                console.error("WebSocket error:", event);
            };
        }

        // Connect WebSocket when the page loads
        document.addEventListener('DOMContentLoaded', function () {
            connectWebSocket();
        });

        // Function to format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
        }
    </script>
</body>
</html>
